const { EventBridgeClient, PutEventsCommand } = require("@aws-sdk/client-eventbridge");
const ebClient = new EventBridgeClient();

module.exports.processResult = async(result, OK, KO, output, add, busName, eventSource) => {
    if (result.length > 0) {
        if (add !== undefined) {
            output[add] = result[0];
        }
        await this.sendEvent(OK, output, busName, eventSource);
    } else {
        await this.sendEvent(KO, output, busName, eventSource);
    }
};

module.exports.sendEvent = async(type, detail, busName, eventSource) => {
    const params = {
        "Entries": [ 
           { 
              "Detail": JSON.stringify(detail),
              "DetailType": type,
              "EventBusName": busName,
              "Source": eventSource
           }
        ]
    };
    const response = await ebClient.send(new PutEventsCommand(params));
    return response;
};
